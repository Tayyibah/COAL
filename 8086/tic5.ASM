.MODEL SMALL
.STACK 100H
.DATA
        NUMS DB '*','*','*','*','*','*','*','*','*'

        MSG1 DB 10,13,10,13,'            VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV',10,13,'            >>>>>>>>>>>>>>>>>>>> PLAYER 1 TURN <<<<<<<<<<<<<<<<<<<<',10,13,'            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^',10,13,'$'
        MSG2 DB 10,13,10,13,'            VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV',10,13,'            >>>>>>>>>>>>>>>>>>>> PLAYER 2 TURN <<<<<<<<<<<<<<<<<<<<',10,13,'            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^',10,13,'$'
        MSG3 DB 10,13,'INVALID INPUT , TRY AGAIN$'
        MSG4 DB 10,13,'ENTER INDEX : $'
        MSG5 DB 10,13,'PALY AGAIN ? (Y/N)$'
        MSG6 DB 10,13,'              |||||||||||||||||||||||||||||||||||||||||||||||||||||||',10,13,'              |||||||||||||||||||||||  GAME START  ||||||||||||||||||',10,13,'              ||||||||||||||||||||||| TIC TAC TOE  ||||||||||||||||||',10,13,'              |||||||||||||||||||||||||||||||||||||||||||||||||||||||',10,13,10,13,'$'
        MSG7 DB 10,13,10,13,'              PLAYER 1 MARK : X        &&       PLAYER 2 MARK : O',10,13,10,13,'$'
        MSG8 DB 10,13,'GAME TIE',10,13,'$'
        MSG9 DB 10,13,10,13,'                   ',16,16,16,16,16,16,16,16,16,16,16,16,2,' PLAYER 1 WINS ',2,17,17,17,17,17,17,17,17,17,17,17,17,10,13,10,13,'$'
        MSG10 DB 10,13,10,13,'                   ',16,16,16,16,16,16,16,16,16,16,16,16,1,' PLAYER 2 WINS ',1,17,17,17,17,17,17,17,17,17,17,17,17,10,13,10,13,'$' 

        MSG DB 10,13,'                                    -------------$'
        SPCS DB '                                    $'                            

.CODE
   MAIN PROC
        MOV AX,@DATA
        MOV DS,AX
        
   START1:
        MOV AH,09
        LEA DX,MSG6
        INT 21H

        LEA SI,NUMS
        MOV CX,9
        OVERWRITE1:
                MOV [SI],BYTE PTR '*'
                INC SI
                DEC CX
                CMP CX,0
                JNE OVERWRITE1

        MOV BL,0
        JMP DISPLAY1
        D1:
                MOV BL,1

        MOV CX,9

;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
;||||||||||||||||||||||||| LOOP FOR TURNS ||||||||||||||||||||||||||||||||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
                                                                      ;|||
WHILE1:                                                               ;|||
        LEA SI,NUMS                                                   ;|||
                                                                      ;|||
        CMP BL,1                                                      ;|||
        JE PLAYER1                                                    ;|||
        JMP PLAYER2                                                   ;|||
                                                                      ;|||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||            ;|||
;||||||||||||||||||||| PLAYER 1 TURN |||||||||||||||||||||            ;|||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||            ;|||
        PLAYER1:                                       ;||            ;|||
                                                       ;||            ;|||
                MOV AH,09                              ;||            ;|||
                LEA DX,MSG1                            ;||            ;|||
                INT 21H                                ;||            ;|||
                                                       ;||            ;|||
                LEA DX,MSG7                            ;||            ;|||
                INT 21H                                ;||            ;|||
                                                       ;||            ;|||
                LEA DX,MSG4                            ;||            ;|||
                INT 21H                                ;||            ;|||
                                                       ;||            ;|||
                MOV AH,01                              ;||            ;|||
                INT 21H                                ;||            ;|||
                                                       ;||            ;|||
                CMP AL,'1'                             ;||            ;|||
                JB INVALID1                            ;||            ;|||
                                                       ;||            ;|||
                CMP AL,'9'                             ;||            ;|||
                JA INVALID1                            ;||            ;|||
                                                       ;||            ;|||
                SUB AL,48                              ;||            ;|||
                                                       ;||            ;|||
                CMP AL,1                               ;||            ;|||
                JE A1                                  ;||            ;|||
                                                       ;||            ;|||
                PLACE:                                 ;||            ;|||
                     INC SI                            ;||            ;|||
                     DEC AL                            ;||            ;|||
                     CMP AL,1                          ;||            ;|||
                     JNE PLACE                         ;||            ;|||
                                                       ;||            ;|||
                A1:                                    ;||            ;|||
                                                       ;||            ;|||
                JMP CHECK1                             ;||            ;|||
                                                       ;||            ;|||
                CONTINUE1_1:                           ;||            ;|||
                                                       ;||            ;|||
                        MOV [SI],BYTE PTR 'X'          ;||            ;|||
                        JMP DISPLAY1                   ;||            ;|||
                                                       ;||            ;|||
                CONTINUE1_2:                           ;||            ;|||
                        MOV BL,2                       ;||            ;|||
                                                       ;||            ;|||
                MOV DL,'X'                             ;||            ;|||
                JMP IF_WIN                             ;||            ;|||
                                                       ;||            ;|||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||            ;|||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||            ;|||
                                                                      ;|||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||            ;|||
;||||||||||||||||||||| PLAYER 2 TURN |||||||||||||||||||||            ;|||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||            ;|||
        PLAYER2:                                       ;||            ;|||
                                                       ;||            ;|||
                MOV AH,09                              ;||            ;|||
                LEA DX,MSG2                            ;||            ;|||
                INT 21H                                ;||            ;|||
                                                       ;||            ;|||
                LEA DX,MSG7                            ;||            ;|||
                INT 21H                                ;||            ;|||
                                                       ;||            ;|||
                LEA DX,MSG4                            ;||            ;|||
                INT 21H                                ;||            ;|||
                                                       ;||            ;|||
                MOV AH,01                              ;||            ;|||
                INT 21H                                ;||            ;|||
                                                       ;||            ;|||
                CMP AL,'1'                             ;||            ;|||
                JB INVALID1                            ;||            ;|||
                                                       ;||            ;|||
                CMP AL,'9'                             ;||            ;|||
                JA INVALID1                            ;||            ;|||
                                                       ;||            ;|||
                SUB AL,48                              ;||            ;|||
                                                       ;||            ;|||
                CMP AL,1                               ;||            ;|||
                JE B1                                  ;||            ;|||
                                                       ;||            ;|||
                PLACE1:                                ;||            ;|||
                     INC SI                            ;||            ;|||
                     DEC AL                            ;||            ;|||
                     CMP AL,1                          ;||            ;|||
                     JNE PLACE1                        ;||            ;|||
                                                       ;||            ;|||
                B1:                                    ;||            ;|||
                JMP CHECK1                             ;||            ;|||
                                                       ;||            ;|||
                CONTINUE2_1:                           ;||            ;|||
                        MOV [SI],BYTE PTR 'O'          ;||            ;|||
                        JMP DISPLAY1                   ;||            ;|||
                                                       ;||            ;|||
                CONTINUE2_2:                           ;||            ;|||
                        MOV BL,1                       ;||            ;|||
                                                       ;||            ;|||
                MOV DL,'O'                             ;||            ;|||
                JMP IF_WIN                             ;||            ;|||
                                                       ;||            ;|||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||            ;|||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||            ;|||
                                                                      ;|||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||            ;|||
;||||||||||||||| CHECKING OCCUPIED OR NOT ||||||||||||||||            ;|||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||            ;|||
        CHECK1:                                        ;||            ;|||
                CMP [SI],BYTE PTR 'X'                  ;||            ;|||
                JE INVALID1                            ;||            ;|||
                                                       ;||            ;|||
                CMP [SI],BYTE PTR 'O'                  ;||            ;|||
                JE INVALID1                            ;||            ;|||
                                                       ;||            ;|||
                CMP BL,1                               ;||            ;|||
                JE CONTINUE1_1                         ;||            ;|||
                JMP CONTINUE2_1                        ;||            ;|||
                                                       ;||            ;|||
        INVALID1:                                      ;||            ;|||
                MOV AH,09                              ;||            ;|||
                LEA DX,MSG3                            ;||            ;|||
                INT 21H                                ;||            ;|||
                                                       ;||            ;|||
        JMP WHILE1                                     ;||            ;|||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||            ;|||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||            ;|||
                                                                      ;|||
        CHECK_WHILE:                                                  ;|||
        DEC CX                                                        ;|||
        CMP CX,0                                                      ;|||
        JE END_WHILE                                                  ;|||
        JMP WHILE1                                                    ;|||
                                                                      ;|||
        END_WHILE:                                                    ;|||
                                                                      ;|||
        MOV AH,09                                                     ;|||
        LEA DX,MSG8                                                   ;|||
        INT 21H                                                       ;|||
                                                                      ;|||
        JMP PLAY_AGAIN                                                ;|||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
;||||||||||||||||||||| DISPLAYING GAME BOARD |||||||||||||||||||||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
                                                               ;||
    DISPLAY1:                                                  ;||
                                                               ;||
        LEA SI,NUMS                                            ;||
        MOV BH,0                                               ;||
        MOV AH,09                                              ;||
        LEA DX,MSG                                             ;||
        INT 21H                                                ;||
                                                               ;||
     LINES:                                                    ;||
                                                               ;||
        MOV AH,02                                              ;||
        MOV DL,10                                              ;||
        INT 21H                                                ;||
                                                               ;||
        MOV AH,09                                              ;||
        LEA DX,SPCS                                            ;||
        INT 21H                                                ;||
                                                               ;||
        MOV AH,02                                              ;||
        MOV DL,'|'                                             ;||
        INT 21H                                                ;||
                                                               ;||
        MOV DL,' '                                             ;||
        INT 21H                                                ;||
                                                               ;||
        MOV DL,[SI]                                            ;||
        INT 21H                                                ;||
        INC SI                                                 ;||
                                                               ;||
        MOV DL,' '                                             ;||
        INT 21H                                                ;||
                                                               ;||
        MOV DL,'|'                                             ;||
        INT 21H                                                ;||
                                                               ;||
        MOV DL,' '                                             ;||
        INT 21H                                                ;||
                                                               ;||
        MOV DL,[SI]                                            ;||
        INT 21H                                                ;||
        INC SI                                                 ;||
                                                               ;||
        MOV DL,' '                                             ;||
        INT 21H                                                ;||
                                                               ;||
        MOV DL,'|'                                             ;||
        INT 21H                                                ;||
                                                               ;||
        MOV DL,' '                                             ;||
        INT 21H                                                ;||               
                                                               ;||
        MOV DL,[SI]                                            ;||
        INT 21H                                                ;||
        INC SI                                                 ;||
                                                               ;||
        MOV DL,' '                                             ;||
        INT 21H                                                ;||
                                                               ;||
        MOV DL,'|'                                             ;||
        INT 21H                                                ;||
                                                               ;||
        MOV AH,09                                              ;||
        LEA DX,MSG                                             ;||
        INT 21H                                                ;||
                                                               ;||
        INC BH                                                 ;||
        CMP BH,3                                               ;||
        JNE LINES                                              ;||
                                                               ;||
        CMP BL,1                                               ;||
        JE CONTINUE1_2                                         ;||
                                                               ;||
        CMP BL,2                                               ;||
        JE CONTINUE2_2                                         ;||
                                                               ;||
        JMP D1                                                 ;||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
;||||||||||||||||||||||||| PLAY AGAIN ||||||||||||||||||||||||||||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
PLAY_AGAIN:                                                    ;||
                                                               ;||
        MOV AH,09                                              ;||
        LEA DX,MSG5                                            ;||
        INT 21H                                                ;||
                                                               ;||
        MOV AH,01                                              ;||
        INT 21H                                                ;||
                                                               ;||
        CMP AL,'N'                                             ;||
        JE END_GAME                                            ;||
        CMP AL,'n'                                             ;||
        JE END_GAME                                            ;||
        CMP AL,'Y'                                             ;||
        JE START1                                              ;||
        CMP AL,'y'                                             ;||
        JE START1                                              ;||
                                                               ;||
        JMP PLAY_AGAIN                                         ;||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

;||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
;|||||||||||||||||||||||||||| WIN OR NOT ||||||||||||||||||||||||||||||||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                              
                                                                     ;|||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||              ;|||
;||||||||| CHECK WHETHER PLAYER WINS OR NOT |||||||||||              ;|||
;||||||||||| CHECKING ALL POSSIBILITIES |||||||||||||||              ;|||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||              ;|||
                                                    ;||              ;|||
IF_WIN:                                             ;||              ;|||
        LEA SI,NUMS                                 ;||              ;|||
                                                    ;||              ;|||
        CMP [SI],DL                                 ;||              ;|||
        JNE CON1_1                                  ;||              ;|||
        CMP [SI+1],DL                               ;||              ;|||
        JNE CON1_1                                  ;||              ;|||
        CMP [SI+2],DL                               ;||              ;|||
        JNE CON1_1                                  ;||              ;|||
        CMP DL,'O'                                  ;||              ;|||
	JE WIN2                                     ;||              ;|||
        JMP WIN1                                    ;||              ;|||
                                                    ;||              ;|||
     CON1_1:                                        ;||              ;|||
        CMP [SI],DL                                 ;||              ;|||
        JNE CON1_2                                  ;||              ;|||
        CMP [SI+3],DL                               ;||              ;|||
        JNE CON1_2                                  ;||              ;|||
        CMP [SI+6],DL                               ;||              ;|||
        JNE CON1_2                                  ;||              ;|||
        CMP DL,'O'                                  ;||              ;|||
	JE WIN2                                     ;||              ;|||
        JMP WIN1                                    ;||              ;|||
                                                    ;||              ;|||
     CON1_2:                                        ;||              ;|||
        CMP [SI],DL                                 ;||              ;|||
        JNE CON1_3                                  ;||              ;|||
        CMP [SI+4],DL                               ;||              ;|||
        JNE CON1_3                                  ;||              ;|||
        CMP [SI+8],DL                               ;||              ;|||
        JNE CON1_3                                  ;||              ;|||
        CMP DL,'O'                                  ;||              ;|||
	JE WIN2                                     ;||              ;|||
	JMP WIN1                                    ;||              ;|||
                                                    ;||              ;|||
     CON1_3:                                        ;||              ;|||
        CMP [SI+1],DL                               ;||              ;|||
        JNE CON1_4                                  ;||              ;|||
        CMP [SI+4],DL                               ;||              ;|||
        JNE CON1_4                                  ;||              ;|||
        CMP [SI+7],DL                               ;||              ;|||
        JNE CON1_4                                  ;||              ;|||
        CMP DL,'O'                                  ;||              ;|||
	JE WIN2                                     ;||              ;|||
	JMP WIN1                                    ;||              ;|||
                                                    ;||              ;|||
    CON1_4:                                         ;||              ;|||
        CMP [SI+2],DL                               ;||              ;|||
        JNE CON1_5                                  ;||              ;|||
        CMP [SI+4],DL                               ;||              ;|||
        JNE CON1_5                                  ;||              ;|||
        CMP [SI+6],DL                               ;||              ;|||
        JNE CON1_5                                  ;||              ;|||
        CMP DL,'O'                                  ;||              ;|||
	JE WIN2                                     ;||              ;|||
	JMP WIN1                                    ;||              ;|||
                                                    ;||              ;|||
    CON1_5:                                         ;||              ;|||
        CMP [SI+2],DL                               ;||              ;|||
        JNE CON1_6                                  ;||              ;|||
        CMP [SI+5],DL                               ;||              ;|||
        JNE CON1_6                                  ;||              ;|||
        CMP [SI+8],DL                               ;||              ;|||
        JNE CON1_6                                  ;||              ;|||
        CMP DL,'O'                                  ;||              ;|||
	JE WIN2                                     ;||              ;|||
	JMP WIN1                                    ;||              ;|||
                                                    ;||              ;|||
    CON1_6:                                         ;||              ;|||
        CMP [SI+3],DL                               ;||              ;|||
        JNE CON1_7                                  ;||              ;|||
        CMP [SI+4],DL                               ;||              ;|||
        JNE CON1_7                                  ;||              ;|||
        CMP [SI+5],DL                               ;||              ;|||
        JNE CON1_7                                  ;||              ;|||
        CMP DL,'O'                                  ;||              ;|||
	JE WIN2                                     ;||              ;|||
	JMP WIN1                                    ;||              ;|||
                                                    ;||              ;|||
    CON1_7:                                         ;||              ;|||
        CMP [SI+6],DL                               ;||              ;|||
        JNE CON1_8                                  ;||              ;|||
        CMP [SI+7],DL                               ;||              ;|||
        JNE CON1_8                                  ;||              ;|||
        CMP [SI+8],DL                               ;||              ;|||
        JNE CON1_8                                  ;||              ;|||
        CMP DL,'O'                                  ;||              ;|||
	JE WIN2                                     ;||              ;|||
	JMP WIN1                                    ;||              ;|||
                                                    ;||              ;|||
    CON1_8:                                         ;||              ;|||                                                   
        JMP CHECK_WHILE                             ;||              ;|||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||              ;|||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||              ;|||
                                                                     ;|||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||              ;|||
;|||||||||||||||| IN CASE PLAYER 1 WIN ||||||||||||||||              ;|||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||              ;|||                                                   
WIN1:                                               ;||              ;|||
        MOV AH,09                                   ;||              ;|||
        LEA DX,MSG9                                 ;||              ;|||
        INT 21H                                     ;||              ;|||
        JMP PLAY_AGAIN                              ;||              ;|||
                                                    ;||              ;|||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||              ;|||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||              ;|||
                                                                     ;|||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||              ;|||
;|||||||||||||||| IN CASE PLAYER 2 WIN ||||||||||||||||              ;|||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||              ;|||
WIN2:                                               ;||              ;|||
        MOV AH,09                                   ;||              ;|||
        LEA DX,MSG10                                ;||              ;|||
        INT 21H                                     ;||              ;|||
        JMP PLAY_AGAIN                              ;||              ;|||
                                                    ;||              ;|||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||              ;|||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||              ;|||
                                                                     ;|||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
;||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
END_GAME:        

MOV AH,4CH
INT 21H
MAIN ENDP
END MAIN
